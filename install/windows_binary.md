## Visual Studio 2022のインストール

https://visualstudio.microsoft.com/ja/vs/whatsnew/
からVisual Studio のダウンロード→Community 2022を選びダウンロードする

ダウンロードしたVisualStudioSetup.exeを実行する。

最初にVisual Studio Installerをインストールする。

Installerのインストールが終わると、ワークロードを選択する画面が出てくるので「C++によるデスクトップ開発」にチェックを入れて「インストール」をクリックする。

なお、ROOTをインタプリタとして使うだけの場合は、Visual Studioのアプリ本体を使うことはない。

## ROOTのインストール

[root_v6.26.00.win32.vc16.exe](https://root.cern/download/root_v6.26.00.win32.vc16.exe) 105MBをダウンロードする。安全かどうか聞かれるが、安全だと思う場合は保存する。

root_v6.26.00.win32.vc16.exe を実行する。WindowsによってPCが保護されましたと出るが、安全だと思う場合は「詳細情報」をクリックして「実行」する。

この不明な発行元からのアプリがデバイスに変更を加えることを許可しますか? も安全だと思う場合は「はい」で。

なお、Windowsがしつこく「安全か?」と聞いてくるのは、最近の多くのアプリには電子署名によって「誰が」「いつ」「どんな」実行ファイルを作ったかをWindowsが保証する仕組みを通しているが、CERNが提供するROOTの実行ファイルはその仕組を通っていないからである。

* ROOT 6.26.00 セットアップウィザードへようこそ 「次へ」
* ライセンス契約書 同意できる場合は「同意する」
* Install Options 「Create ROOT Desktop Icon」にチェックを入れて「次へ」
* インストール先を選んでください。「C:\root_v6.26.00」のまま「次へ」
* スタートメニューフォルダを選んでください。もそのまま「次へ」
* コンポーネントを選んでください。もそのまま「次へ」
* インストールが始まる。


## ROOT環境設定

エクスプローラを開き、上の「表示」バーの「表示/非表示」の「ファイル名拡張子」にチェックを入れておく。

ROOTを簡単に実行するためのbatファイルを作る。

作業したいフォルダ内で、
右クリック→新規作成→テキストドキュメント
で「setenv.bat」というファイルを作る。「setenv.bat.txt」ではない。
「拡張子を変更すると、ファイルが使えなくなる可能性があります。変更しますか?」は「はい」とする。

ファイルを右クリックし、編集をおすと、編集できるので、

```
@echo off
call C:\root_v6.26.00\bin\thisroot.bat
cmd /k
```

と記述し保存する。

setenv.batを起動して、「root」というコマンドを実行すると、ROOTのロゴが表示されコマンドプロンプト上には以下のように表示される。

```
   ------------------------------------------------------------------
  | Welcome to ROOT 6.26/00                        https://root.cern |
  | (c) 1995-2021, The ROOT Team; conception: R. Brun, F. Rademakers |
  | Built for win32 on Mar 03 2022, 06:51:13                         |
  | From tags/v6-26-00@v6-26-00                                      |
  | With MSVC 19.29.30139.0                                          |
  | Try '.help', '.demo', '.license', '.credits', '.quit'/'.q'       |
   ------------------------------------------------------------------

root [0] .q
```

ROOTを使うときはこのsetenv.batを実行して開いたコマンドプロンプト上で行うこと。また、setenv.batは作業したいフォルダにコピペしておいておくと良いだろう。

文責: 吉本雅浩
